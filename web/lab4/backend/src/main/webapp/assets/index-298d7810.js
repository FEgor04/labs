import{A as m,a as k,u as g}from"./api-f187c826.js";import{u as v,c as y}from"./createLucideIcon-97e7f368.js";import{_ as u}from"./Button.vue_vue_type_script_setup_true_lang-0db4ac5a.js";import{d as f,u as w,r as x,o as r,c,a as l,b as e,w as n,e as i,f as _,F as L}from"./index-fbd9a00a.js";async function C(){const o=await k.get("/v1/me");return o.status==200?o.data:null}function I(){return v({queryKey:["viewer"],queryFn:C,retry(o,t){var s;return t=="Bad refresh token"?(console.log("Bad refresh token. will not try again"),!1):t=="JWT Token not set. Proceed to authorization page."?(console.log("No JWT token. Will not try again"),!1):t instanceof m&&(((s=t.response)==null?void 0:s.status)??0)==401?!1:o<5}})}const $=y("CrosshairIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]]),T=y("LogOutIcon",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),b={class:"p-4 space-y-4 items-center flex flex-col"},q=l("h1",{class:"text-2xl text-center font-bold"},"Вы вошли",-1),B={class:"flex flex-row space-x-6"},R=f({__name:"isLoggedIn",props:["refetch"],setup(o){const t=o,s=g(),a=w();function d(){console.log("Logging out"),localStorage.removeItem("refreshToken"),localStorage.removeItem("accessToken"),s.clear(),s.invalidateQueries({queryKey:["viewer"]}),a.push("/"),t.refetch()}return(h,A)=>{const p=x("RouterLink");return r(),c("div",b,[q,l("div",B,[e(p,{to:"/main"},{default:n(()=>[e(u,null,{default:n(()=>[e(i($),{class:"w-4 h-4 mr-2"}),_(" Стрельнуть ")]),_:1})]),_:1}),e(u,{variant:"secondary",onClick:d},{default:n(()=>[e(i(T),{class:"w-4 h-4 mr-2"}),_(" Выйти ")]),_:1})])])}}}),N=l("h1",{class:"text-left text-2xl font-bold md:text-center"}," Сначала нужно войти в систему или зарегистрироваться ",-1),Q={class:"flex flex-row justify-start md:justify-center space-x-4"},V=f({__name:"needToLogIn",setup(o){return(t,s)=>{const a=x("RouterLink");return r(),c(L,null,[N,l("div",Q,[e(a,{to:"/signin"},{default:n(()=>[e(u,null,{default:n(()=>[_(" Войти ")]),_:1})]),_:1}),e(a,{to:"/signup"},{default:n(()=>[e(u,{variant:"secondary"},{default:n(()=>[_(" Зарегистрироваться ")]),_:1})]),_:1})])],64)}}}),F={key:0},M=l("h1",{class:"text-center font-bold text-2xl p-4"},"Загрузка..",-1),O=[M],W={key:1},j={key:0},z={key:1,class:"p-4 container mx-auto space-y-8"},G=f({__name:"index",setup(o){const{data:t,isLoading:s,refetch:a}=I();return(d,h)=>i(s)?(r(),c("div",F,O)):(r(),c("div",W,[i(t)!=null?(r(),c("div",j,[e(R,{refetch:i(a)},null,8,["refetch"])])):(r(),c("div",z,[e(V)]))]))}});export{G as default};
